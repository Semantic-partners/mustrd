SELECT ?s WHERE {
    ?s <test:p1> ?o1 ;
       <test:p2> ?o2
    FILTER NOT EXISTS {
        {
            ?o1 <test:p3> ?o3 .
        } UNION {
            FILTER(?o2< 1)
        }
    }
}